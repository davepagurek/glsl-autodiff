/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it uses a non-standard name for the exports (exports).
(() => {
var exports = __webpack_exports__;
/*!******************!*\
  !*** ./index.ts ***!
  \******************/

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.AutoDiff = void 0;
class Op {
    constructor(ad, ...params) {
        this.usedIn = [];
        this.ad = ad;
        this.id = ad.getNextID();
        this.dependsOn = params;
        for (const param of params) {
            param.usedIn.push(this);
        }
    }
    ref() {
        if (this.usedIn.length > 0) {
            return `_glslad_v${this.id}`;
        }
        else {
            return `(${this.definition()})`;
        }
    }
    derivRef(param) {
        if (this.usedIn.length > 0) {
            return `_glslad_dv${this.id}_d${param.name}`;
        }
        else {
            return `(${this.derivative(param)})`;
        }
    }
    initializer() {
        if (this.usedIn.length > 0) {
            return `float ${this.ref()}=${this.definition()};\n`;
        }
        else {
            return '';
        }
    }
    derivInitializer(param) {
        if (this.usedIn.length > 0) {
            return `float ${this.derivRef(param)}=${this.derivative(param)};\n`;
        }
        else {
            return '';
        }
    }
    isConst() {
        return this.dependsOn.every((op) => op.isConst());
    }
    deepDependencies() {
        const deps = new Set();
        for (const op of this.dependsOn) {
            for (const dep of op.deepDependencies().values()) {
                deps.add(dep);
            }
            deps.add(op);
        }
        return deps;
    }
    add(...params) { return this.ad.add(this, ...params); }
    sum(...params) { return this.ad.sum(this, ...params); }
    sub(b) { return this.ad.sub(this, b); }
    neg() { return this.ad.neg(this); }
    mult(...params) { return this.ad.mult(this, ...params); }
    div(b) { return this.ad.div(this, b); }
    pow(b) { return this.ad.pow(this, b); }
    sqrt() { return this.ad.sqrt(this); }
    sin() { return this.ad.sin(this); }
    cos() { return this.ad.cos(this); }
    tan() { return this.ad.cos(this); }
    mix(b, mix) { return this.ad.mix(this, b, mix); }
    clamp(min, max) { return this.ad.clamp(this, min, max); }
    min(other) { return this.ad.min(this, other); }
    max(other) { return this.ad.max(this, other); }
    ifelse(thenOp, elseOp) { return this.ad.ifelse(this, thenOp, elseOp); }
    output(name) { return this.ad.output(name, this); }
    outputDeriv(name, param) { return this.ad.outputDeriv(name, param, this); }
}
class OpLiteral extends Op {
    initializer() { return ''; }
    derivInitializer() { return ''; }
    ref() { return this.definition(); }
    derivRef(param) { return this.derivative(param); }
}
class Param extends OpLiteral {
    constructor(ad, name) {
        super(ad);
        this.name = name;
    }
    isConst() { return false; }
    definition() { return this.name; }
    derivative(param) {
        if (param === this) {
            return '1.0';
        }
        else {
            return '0.0';
        }
    }
}
class Value extends OpLiteral {
    constructor(ad, val) {
        super(ad);
        this.val = val;
    }
    isConst() { return true; }
    definition() { return `${this.val.toFixed(4)}`; }
    derivative() { return '0.0'; }
}
class Neg extends Op {
    definition() {
        return `-${this.dependsOn[0].ref()}`;
    }
    derivative(param) {
        return '-' + this.dependsOn[0].derivRef(param);
    }
}
class Sum extends Op {
    definition() {
        return this.dependsOn.map((op) => op.ref()).join('+');
    }
    derivative(param) {
        return this.dependsOn.map((op) => op.derivRef(param)).join('+');
    }
}
class Mult extends Op {
    definition() {
        return this.dependsOn.map((op) => op.ref()).join('*');
    }
    derivative(param) {
        const [f, g] = this.dependsOn;
        return `${f.ref()}*${g.derivRef(param)}+${g.ref()}*${f.derivRef(param)}`;
    }
}
class Div extends Op {
    definition() {
        return this.dependsOn.map((op) => op.ref()).join('/');
    }
    derivative(param) {
        const [f, g] = this.dependsOn;
        return `(${f.derivRef(param)}*${g.ref()}-${g.derivRef(param)}*${f.ref()})/(${g.ref()}*${g.ref()})`;
    }
}
class Pow extends Op {
    definition() {
        return `pow(${this.dependsOn[0].ref()},${this.dependsOn[1].ref()})`;
    }
    derivative(param) {
        const [a, b] = this.dependsOn;
        if (this.isConst()) {
            return `${b.ref()}*pow(${a.ref()},${b.ref()}-1)`;
        }
        else {
            return `pow(${a.ref()},${b.ref()})*log(${a.ref()})*${b.derivRef(param)}`;
        }
    }
}
class Sin extends Op {
    definition() {
        return `sin(${this.dependsOn[0].ref()})`;
    }
    derivative(param) {
        return `cos(${this.dependsOn[0].ref()})*${this.dependsOn[0].derivRef(param)}`;
    }
}
class Cos extends Op {
    definition() {
        return `cos(${this.dependsOn[0].ref()})`;
    }
    derivative(param) {
        return `-sin(${this.dependsOn[0].ref()})*${this.dependsOn[0].derivRef(param)}`;
    }
}
class Mix extends Op {
    definition() {
        return `mix(${this.dependsOn.map((op) => op.ref()).join(',')})`;
    }
    derivative(param) {
        const [a, b, mix] = this.dependsOn;
        const aDeriv = `(1.0-${a.ref()})*${mix.derivRef(param)}+(-${a.derivRef(param)})*${mix.ref()}`;
        const bDeriv = `${b.ref()}*${mix.derivRef(param)}+${b.derivRef(param)}*${mix.ref()}`;
        return `${aDeriv}+${bDeriv}`;
    }
}
class Clamp extends Op {
    definition() {
        return `clamp(${this.dependsOn.map((op) => op.ref()).join(',')})`;
    }
    derivative(param) {
        const [v, min, max] = this.dependsOn;
        return `${v.ref()}<${min.ref()} ? 0.0 : (${v.ref()}>${max.ref()} ? 0.0 : ${v.derivRef(param)})`;
    }
}
class Min extends Op {
    definition() {
        return `min(${this.dependsOn.map((op) => op.ref()).join(',')})`;
    }
    derivative(param) {
        const [a, b] = this.dependsOn;
        return `${a.ref()}<${b.ref()} ? ${a.derivRef(param)} : ${b.derivRef(param)}`;
    }
}
class Max extends Op {
    definition() {
        return `max(${this.dependsOn.map((op) => op.ref()).join(',')})`;
    }
    derivative(param) {
        const [a, b] = this.dependsOn;
        return `${a.ref()}>${b.ref()} ? ${a.derivRef(param)} : ${b.derivRef(param)}`;
    }
}
class IfElse extends Op {
    definition() {
        const [condition, thenOp, elseOp] = this.dependsOn;
        return `${condition.ref()}?${thenOp.ref()}:${elseOp.ref()}`;
    }
    derivative(param) {
        const [condition, thenOp, elseOp] = this.dependsOn;
        return `${condition.ref()}?${thenOp.derivRef(param)}:${elseOp.derivRef(param)}`;
    }
}
class AutoDiff {
    constructor() {
        this.nextID = 0;
        this.params = {};
        this.outputs = {};
        this.derivOutputs = {};
    }
    getNextID() {
        const id = this.nextID;
        this.nextID++;
        return id;
    }
    convertVal(param) {
        if (param instanceof Op) {
            return param;
        }
        else {
            return this.val(param);
        }
    }
    convertVals(params) {
        return params.map((param) => this.convertVal(param));
    }
    val(n) { return new Value(this, n); }
    sum(...params) { return new Sum(this, ...this.convertVals(params)); }
    add(...params) { return new Sum(this, ...this.convertVals(params)); }
    sub(a, b) {
        const [opA, opB] = this.convertVals([a, b]);
        return this.sum(opA, this.neg(opB));
    }
    neg(v) { return new Neg(this, this.convertVal(v)); }
    mult(...params) {
        if (params.length === 2) {
            return new Mult(this, ...this.convertVals(params));
        }
        else if (params.length > 2) {
            return new Mult(this, this.convertVals(params.slice(0, 1))[0], this.mult(...params.slice(1)));
        }
        else {
            throw new Error(`mult() called with too few arguments: ${params}`);
        }
    }
    div(a, b) {
        const [opA, opB] = this.convertVals([a, b]);
        return new Div(this, opA, opB);
    }
    pow(a, b) {
        const [opA, opB] = this.convertVals([a, b]);
        return new Pow(this, opA, opB);
    }
    sqrt(v) { return new Pow(this, this.convertVal(v), this.val(0.5)); }
    sin(v) { return new Sin(this, this.convertVal(v)); }
    cos(v) { return new Cos(this, this.convertVal(v)); }
    tan(v) {
        const op = this.convertVal(v);
        return this.div(this.sin(op), this.cos(op));
    }
    mix(a, b, mix) { return new Mix(this, ...this.convertVals([a, b, mix])); }
    clamp(v, min, max) { return new Clamp(this, ...this.convertVals([v, min, max])); }
    min(a, b) { return new Min(this, ...this.convertVals([a, b])); }
    max(a, b) { return new Max(this, ...this.convertVals([a, b])); }
    ifelse(cond, thenOp, elseOp) { return new IfElse(this, ...this.convertVals([cond, thenOp, elseOp])); }
    e() { return this.val(Math.E); }
    pi() { return this.val(Math.PI); }
    param(name) {
        const op = new Param(this, name);
        this.params[name] = op;
        return op;
    }
    output(name, op) {
        this.outputs[name] = op;
    }
    outputDeriv(name, param, op) {
        const paramName = typeof param === 'string' ? param : param.name;
        this.derivOutputs[paramName] = this.derivOutputs[paramName] || {};
        this.derivOutputs[paramName][name] = op;
    }
    gen() {
        let code = '';
        const deps = new Set();
        for (const name in this.outputs) {
            for (const dep of this.outputs[name].deepDependencies().values()) {
                deps.add(dep);
            }
            deps.add(this.outputs[name]);
        }
        for (const param in this.derivOutputs) {
            for (const name in this.derivOutputs[param]) {
                for (const dep of this.derivOutputs[param][name].deepDependencies().values()) {
                    deps.add(dep);
                }
                deps.add(this.derivOutputs[param][name]);
            }
        }
        for (const dep of deps.values()) {
            code += dep.initializer();
        }
        for (const name in this.outputs) {
            code += `float ${name}=${this.outputs[name].ref()};\n`;
        }
        for (const param in this.derivOutputs) {
            const paramOp = this.params[param];
            const derivDeps = new Set();
            for (const name in this.derivOutputs[param]) {
                for (const dep of this.derivOutputs[param][name].deepDependencies().values()) {
                    derivDeps.add(dep);
                }
                derivDeps.add(this.derivOutputs[param][name]);
            }
            for (const dep of derivDeps.values()) {
                code += dep.derivInitializer(paramOp);
            }
            for (const name in this.derivOutputs[param]) {
                code += `float ${name}=${this.derivOutputs[param][name].derivRef(paramOp)};\n`;
            }
        }
        return code;
    }
    static gen(cb) {
        const ad = new AutoDiff();
        cb(ad);
        return ad.gen();
    }
}
exports.AutoDiff = AutoDiff;
window.AutoDiff = window.AutoDiff || AutoDiff;

})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFFQSxNQUFlLEVBQUU7SUFPZixZQUFZLEVBQVksRUFBRSxHQUFHLE1BQVk7UUFIbEMsV0FBTSxHQUFTLEVBQUU7UUFJdEIsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFO1FBQ1osSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsU0FBUyxFQUFFO1FBQ3hCLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBTTtRQUN2QixLQUFLLE1BQU0sS0FBSyxJQUFJLE1BQU0sRUFBRTtZQUMxQixLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7U0FDeEI7SUFDSCxDQUFDO0lBRU0sR0FBRztRQUNSLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQzFCLE9BQU8sWUFBWSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQzdCO2FBQU07WUFDTCxPQUFPLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxHQUFHO1NBQ2hDO0lBQ0gsQ0FBQztJQUVNLFFBQVEsQ0FBQyxLQUFZO1FBQzFCLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQzFCLE9BQU8sYUFBYSxJQUFJLENBQUMsRUFBRSxLQUFLLEtBQUssQ0FBQyxJQUFJLEVBQUU7U0FDN0M7YUFBTTtZQUNMLE9BQU8sSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxHQUFHO1NBQ3JDO0lBQ0gsQ0FBQztJQUVNLFdBQVc7UUFDaEIsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDMUIsT0FBTyxTQUFTLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFLEtBQUs7U0FDckQ7YUFBTTtZQUNMLE9BQU8sRUFBRTtTQUNWO0lBQ0gsQ0FBQztJQUVNLGdCQUFnQixDQUFDLEtBQVk7UUFDbEMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDMUIsT0FBTyxTQUFTLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsS0FBSztTQUNwRTthQUFNO1lBQ0wsT0FBTyxFQUFFO1NBQ1Y7SUFDSCxDQUFDO0lBRU0sT0FBTztRQUNaLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUNuRCxDQUFDO0lBRU0sZ0JBQWdCO1FBQ3JCLE1BQU0sSUFBSSxHQUFHLElBQUksR0FBRyxFQUFNO1FBQzFCLEtBQUssTUFBTSxFQUFFLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUMvQixLQUFLLE1BQU0sR0FBRyxJQUFJLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDLE1BQU0sRUFBRSxFQUFFO2dCQUNoRCxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQzthQUNkO1lBQ0QsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7U0FDYjtRQUNELE9BQU8sSUFBSTtJQUNiLENBQUM7SUFHTSxHQUFHLENBQUMsR0FBRyxNQUFlLElBQUksT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxNQUFNLENBQUMsRUFBQyxDQUFDO0lBQy9ELEdBQUcsQ0FBQyxHQUFHLE1BQWUsSUFBSSxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxHQUFHLE1BQU0sQ0FBQyxFQUFDLENBQUM7SUFDL0QsR0FBRyxDQUFDLENBQVEsSUFBSSxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsRUFBQyxDQUFDO0lBQzdDLEdBQUcsS0FBSyxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFDLENBQUM7SUFDbEMsSUFBSSxDQUFDLEdBQUcsTUFBZSxJQUFJLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsTUFBTSxDQUFDLEVBQUMsQ0FBQztJQUNqRSxHQUFHLENBQUMsQ0FBUSxJQUFJLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUFDLENBQUM7SUFDN0MsR0FBRyxDQUFDLENBQVEsSUFBSSxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsRUFBQyxDQUFDO0lBQzdDLElBQUksS0FBSyxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFDLENBQUM7SUFDcEMsR0FBRyxLQUFLLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUMsQ0FBQztJQUNsQyxHQUFHLEtBQUssT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBQyxDQUFDO0lBQ2xDLEdBQUcsS0FBSyxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFDLENBQUM7SUFDbEMsR0FBRyxDQUFDLENBQVEsRUFBRSxHQUFVLElBQUksT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFDLENBQUM7SUFDOUQsS0FBSyxDQUFDLEdBQVUsRUFBRSxHQUFVLElBQUksT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxFQUFDLENBQUM7SUFDdEUsR0FBRyxDQUFDLEtBQVksSUFBSSxPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxLQUFLLENB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SyxTQUFRLEVBQUU7SUFDbkIsVUFBVTtRQUNSLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDdkQsQ0FBQztJQUNELFVBQVUsQ0FBQyxLQUFZO1FBQ3JCLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVM7UUFDN0IsT0FBTyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFO0lBQzFFLENBQUM7Q0FDRjtBQUVELE1BQU0sR0FBSSxTQUFRLEVBQUU7SUFDbEIsVUFBVTtRQUNSLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDdkQsQ0FBQztJQUNELFVBQVUsQ0FBQyxLQUFZO1FBQ3JCLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVM7UUFDN0IsT0FBTyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUc7SUFDcEcsQ0FBQztDQUNGO0FBRUQsTUFBTSxHQUFJLFNBQVEsRUFBRTtJQUNsQixVQUFVO1FBQ1IsT0FBTyxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENB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LElBQUksR0FBRyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQztJQUMxRCxHQUFHLENBQUMsQ0FBUTtRQUNqQixNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUM3QixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzdDLENBQUM7SUFDTSxHQUFHLENBQUMsQ0FBUSxFQUFFLENBQVEsRUFBRSxHQUFVLElBQUksT0FBTyxJQUFJLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQztJQUM5RixLQUFLLENBQUMsQ0FBUSxFQUFFLEdBQVUsRUFBRSxHQUFVLElBQUksT0FBTyxJQUFJLEtBQUssQ0FBQyxJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQztJQUN0RyxHQUFHLENBQUMsQ0FBUSxFQUFFLENBQVEsSUFBSSxPQUFPLElBQUksR0FBRyxDQUFDLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUM7SUFDN0UsR0FBRyxDQUFDLENBQVEsRUFBRSxDQUFRLElBQUksT0FBTyxJQUFJLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDO0lBQzdFLE1BQU0sQ0FBQyxJQUFXLEVBQUUsTUFBYSxFQUFFLE1BQWEsSUFBSSxPQUFPLElBQUksTUFBTSxD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LElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQzNDLEtBQUssTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDLE1BQU0sRUFBRSxFQUFFO29CQUM1RSxTQUFTLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztpQkFDbkI7Z0JBQ0QsU0FBUyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQzlDO1lBQ0QsS0FBSyxNQUFNLEdBQUcsSUFBSSxTQUFTLENBQUMsTUFBTSxFQUFFLEVBQUU7Z0JBQ3BDLElBQUksSUFBSSxHQUFHLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDO2FBQ3RDO1lBR0QsS0FBSyxNQUFNLElBQUksSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUMzQyxJQUFJLElBQUksU0FBUyxJQUFJLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEtBQUs7YUFDL0U7U0FDRjtRQUVELE9BQU8sSUFBSTtJQUNiLENBQUM7SUFJTSxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQXdCO1FBQ3hDLE1BQU0sRUFBRSxHQUFHLElBQUksUUFBUSxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDTixPQUFPLEVBQUUsQ0FBQyxHQUFHLEVBQUU7SUFDakIsQ0FBQztDQUNGO0FBMUlELDRCQTBJQztBQU1ELE1BQU0sQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsSUFBSSxRQUFRIiwiZmlsZSI6ImF1dG9kaWZmLmpzIiwic291cmNlc0NvbnRlbnQiOlsidHlwZSBJbnB1dCA9IE9wIHwgbnVtYmVyXG5cbmFic3RyYWN0IGNsYXNzIE9wIHtcbiAgcHJvdGVjdGVkIGFkOiBBdXRvRGlmZlxuICBwdWJsaWMgaWQ6IG51bWJlclxuICBwdWJsaWMgZGVwZW5kc09uOiBPcFtdXG4gIHB1YmxpYyB1c2VkSW46IE9wW10gPSBbXVxuICBwdWJsaWMgc3RhdGljIGtleTogc3RyaW5nXG5cbiAgY29uc3RydWN0b3IoYWQ6IEF1dG9EaWZmLCAuLi5wYXJhbXM6IE9wW10pIHtcbiAgICB0aGlzLmFkID0gYWRcbiAgICB0aGlzLmlkID0gYWQuZ2V0TmV4dElEKClcbiAgICB0aGlzLmRlcGVuZHNPbiA9IHBhcmFtc1xuICAgIGZvciAoY29uc3QgcGFyYW0gb2YgcGFyYW1zKSB7XG4gICAgICBwYXJhbS51c2VkSW4ucHVzaCh0aGlzKVxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyByZWYoKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy51c2VkSW4ubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGBfZ2xzbGFkX3Yke3RoaXMuaWR9YFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYCgke3RoaXMuZGVmaW5pdGlvbigpfSlgXG4gICAgfVxuICB9XG5cbiAgcHVibGljIGRlcml2UmVmKHBhcmFtOiBQYXJhbSk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMudXNlZEluLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBgX2dsc2xhZF9kdiR7dGhpcy5pZH1fZCR7cGFyYW0ubmFtZX1gXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBgKCR7dGhpcy5kZXJpdmF0aXZlKHBhcmFtKX0pYFxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBpbml0aWFsaXplcigpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLnVzZWRJbi5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gYGZsb2F0ICR7dGhpcy5yZWYoKX09JHt0aGlzLmRlZmluaXRpb24oKX07XFxuYFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJydcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZGVyaXZJbml0aWFsaXplcihwYXJhbTogUGFyYW0pOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLnVzZWRJbi5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gYGZsb2F0ICR7dGhpcy5kZXJpdlJlZihwYXJhbSl9PSR7dGhpcy5kZXJpdmF0aXZlKHBhcmFtKX07XFxuYFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJydcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgaXNDb25zdCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5kZXBlbmRzT24uZXZlcnkoKG9wKSA9PiBvcC5pc0NvbnN0KCkpXG4gIH1cblxuICBwdWJsaWMgZGVlcERlcGVuZGVuY2llcygpOiBTZXQ8T3A+IHtcbiAgICBjb25zdCBkZXBzID0gbmV3IFNldDxPcD4oKVxuICAgIGZvciAoY29uc3Qgb3Agb2YgdGhpcy5kZXBlbmRzT24pIHtcbiAgICAgIGZvciAoY29uc3QgZGVwIG9mIG9wLmRlZXBEZXBlbmRlbmNpZXMoKS52YWx1ZXMoKSkge1xuICAgICAgICBkZXBzLmFkZChkZXApXG4gICAgICB9XG4gICAgICBkZXBzLmFkZChvcClcbiAgICB9XG4gICAgcmV0dXJuIGRlcHNcbiAgfVxuXG4gIC8vIENoYWluaW5nIGhlbHBlcnNcbiAgcHVibGljIGFkZCguLi5wYXJhbXM6IElucHV0W10pIHsgcmV0dXJuIHRoaXMuYWQuYWRkKHRoaXMsIC4uLnBhcmFtcykgfVxuICBwdWJsaWMgc3VtKC4uLnBhcmFtczogSW5wdXRbXSkgeyByZXR1cm4gdGhpcy5hZC5zdW0odGhpcywgLi4ucGFyYW1zKSB9XG4gIHB1YmxpYyBzdWIoYjogSW5wdXQpIHsgcmV0dXJuIHRoaXMuYWQuc3ViKHRoaXMsIGIpIH1cbiAgcHVibGljIG5lZygpIHsgcmV0dXJuIHRoaXMuYWQubmVnKHRoaXMpIH1cbiAgcHVibGljIG11bHQoLi4ucGFyYW1zOiBJbnB1dFtdKSB7IHJldHVybiB0aGlzLmFkLm11bHQodGhpcywgLi4ucGFyYW1zKSB9XG4gIHB1YmxpYyBkaXYoYjogSW5wdXQpIHsgcmV0dXJuIHRoaXMuYWQuZGl2KHRoaXMsIGIpIH1cbiAgcHVibGljIHBvdyhiOiBJbnB1dCkgeyByZXR1cm4gdGhpcy5hZC5wb3codGhpcywgYikgfVxuICBwdWJsaWMgc3FydCgpIHsgcmV0dXJuIHRoaXMuYWQuc3FydCh0aGlzKSB9XG4gIHB1YmxpYyBzaW4oKSB7IHJldHVybiB0aGlzLmFkLnNpbih0aGlzKSB9XG4gIHB1YmxpYyBjb3MoKSB7IHJldHVybiB0aGlzLmFkLmNvcyh0aGlzKSB9XG4gIHB1YmxpYyB0YW4oKSB7IHJldHVybiB0aGlzLmFkLmNvcyh0aGlzKSB9XG4gIHB1YmxpYyBtaXgoYjogSW5wdXQsIG1peDogSW5wdXQpIHsgcmV0dXJuIHRoaXMuYWQubWl4KHRoaXMsIGIsIG1peCkgfVxuICBwdWJsaWMgY2xhbXAobWluOiBJbnB1dCwgbWF4OiBJbnB1dCkgeyByZXR1cm4gdGhpcy5hZC5jbGFtcCh0aGlzLCBtaW4sIG1heCkgfVxuICBwdWJsaWMgbWluKG90aGVyOiBJbnB1dCkgeyByZXR1cm4gdGhpcy5hZC5taW4odGhpcywgb3RoZXIpIH1cbiAgcHVibGljIG1heChvdGhlcjogSW5wdXQpIHsgcmV0dXJuIHRoaXMuYWQubWF4KHRoaXMsIG90aGVyKSB9XG4gIHB1YmxpYyBpZmVsc2UodGhlbk9wOiBJbnB1dCwgZWxzZU9wOiBJbnB1dCkgeyByZXR1cm4gdGhpcy5hZC5pZmVsc2UodGhpcywgdGhlbk9wLCBlbHNlT3ApIH1cblxuICBwdWJsaWMgb3V0cHV0KG5hbWU6IHN0cmluZykgeyByZXR1cm4gdGhpcy5hZC5vdXRwdXQobmFtZSwgdGhpcykgfVxuICBwdWJsaWMgb3V0cHV0RGVyaXYobmFtZTogc3RyaW5nLCBwYXJhbTogUGFyYW0gfCBzdHJpbmcpIHsgcmV0dXJuIHRoaXMuYWQub3V0cHV0RGVyaXYobmFtZSwgcGFyYW0sIHRoaXMpIH1cblxuICBwdWJsaWMgYWJzdHJhY3QgZGVmaW5pdGlvbigpOiBzdHJpbmdcbiAgcHVibGljIGFic3RyYWN0IGRlcml2YXRpdmUocGFyYW06IFBhcmFtKTogc3RyaW5nXG59XG5cbmFic3RyYWN0IGNsYXNzIE9wTGl0ZXJhbCBleHRlbmRzIE9wIHtcbiAgcHVibGljIG92ZXJyaWRlIGluaXRpYWxpemVyKCkgeyByZXR1cm4gJycgfVxuICBwdWJsaWMgb3ZlcnJpZGUgZGVyaXZJbml0aWFsaXplcigpIHsgcmV0dXJuICcnIH1cbiAgcHVibGljIG92ZXJyaWRlIHJlZigpIHsgcmV0dXJuIHRoaXMuZGVmaW5pdGlvbigpIH1cbiAgcHVibGljIG92ZXJyaWRlIGRlcml2UmVmKHBhcmFtOiBQYXJhbSkgeyByZXR1cm4gdGhpcy5kZXJpdmF0aXZlKHBhcmFtKSB9XG59XG5cbmNsYXNzIFBhcmFtIGV4dGVuZHMgT3BMaXRlcmFsIHtcbiAgcHVibGljIG5hbWU6IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yKGFkOiBBdXRvRGlmZiwgbmFtZTogc3RyaW5nKSB7XG4gICAgc3VwZXIoYWQpXG4gICAgdGhpcy5uYW1lID0gbmFtZVxuICB9XG5cbiAgaXNDb25zdCgpIHsgcmV0dXJuIGZhbHNlIH1cbiAgZGVmaW5pdGlvbigpIHsgcmV0dXJuIHRoaXMubmFtZSB9XG4gIGRlcml2YXRpdmUocGFyYW06IFBhcmFtKSB7XG4gICAgaWYgKHBhcmFtID09PSB0aGlzKSB7XG4gICAgICByZXR1cm4gJzEuMCdcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcwLjAnXG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFZhbHVlIGV4dGVuZHMgT3BMaXRlcmFsIHtcbiAgcHJpdmF0ZSB2YWw6IG51bWJlclxuXG4gIGNvbnN0cnVjdG9yKGFkOiBBdXRvRGlmZiwgdmFsOiBudW1iZXIpIHtcbiAgICBzdXBlcihhZClcbiAgICB0aGlzLnZhbCA9IHZhbFxuICB9XG5cbiAgaXNDb25zdCgpIHsgcmV0dXJuIHRydWUgfVxuICBkZWZpbml0aW9uKCkgeyByZXR1cm4gYCR7dGhpcy52YWwudG9GaXhlZCg0KX1gIH1cbiAgZGVyaXZhdGl2ZSgpIHsgcmV0dXJuICcwLjAnIH1cbn1cblxuY2xhc3MgTmVnIGV4dGVuZHMgT3Age1xuICBkZWZpbml0aW9uKCkge1xuICAgIHJldHVybiBgLSR7dGhpcy5kZXBlbmRzT25bMF0ucmVmKCl9YFxuICB9XG4gIGRlcml2YXRpdmUocGFyYW06IFBhcmFtKSB7XG4gICAgcmV0dXJuICctJyArIHRoaXMuZGVwZW5kc09uWzBdLmRlcml2UmVmKHBhcmFtKVxuICB9XG59XG5cbmNsYXNzIFN1bSBleHRlbmRzIE9wIHtcbiAgZGVmaW5pdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5kZXBlbmRzT24ubWFwKChvcCkgPT4gb3AucmVmKCkpLmpvaW4oJysnKVxuICB9XG4gIGRlcml2YXRpdmUocGFyYW06IFBhcmFtKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVwZW5kc09uLm1hcCgob3ApID0+IG9wLmRlcml2UmVmKHBhcmFtKSkuam9pbignKycpXG4gIH1cbn1cblxuY2xhc3MgTXVsdCBleHRlbmRzIE9wIHtcbiAgZGVmaW5pdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5kZXBlbmRzT24ubWFwKChvcCkgPT4gb3AucmVmKCkpLmpvaW4oJyonKVxuICB9XG4gIGRlcml2YXRpdmUocGFyYW06IFBhcmFtKSB7XG4gICAgY29uc3QgW2YsIGddID0gdGhpcy5kZXBlbmRzT25cbiAgICByZXR1cm4gYCR7Zi5yZWYoKX0qJHtnLmRlcml2UmVmKHBhcmFtKX0rJHtnLnJlZigpfSoke2YuZGVyaXZSZWYocGFyYW0pfWBcbiAgfVxufVxuXG5jbGFzcyBEaXYgZXh0ZW5kcyBPcCB7XG4gIGRlZmluaXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVwZW5kc09uLm1hcCgob3ApID0+IG9wLnJlZigpKS5qb2luKCcvJylcbiAgfVxuICBkZXJpdmF0aXZlKHBhcmFtOiBQYXJhbSkge1xuICAgIGNvbnN0IFtmLCBnXSA9IHRoaXMuZGVwZW5kc09uXG4gICAgcmV0dXJuIGAoJHtmLmRlcml2UmVmKHBhcmFtKX0qJHtnLnJlZigpfS0ke2cuZGVyaXZSZWYocGFyYW0pfSoke2YucmVmKCl9KS8oJHtnLnJlZigpfSoke2cucmVmKCl9KWBcbiAgfVxufVxuXG5jbGFzcyBQb3cgZXh0ZW5kcyBPcCB7XG4gIGRlZmluaXRpb24oKSB7XG4gICAgcmV0dXJuIGBwb3coJHt0aGlzLmRlcGVuZHNPblswXS5yZWYoKX0sJHt0aGlzLmRlcGVuZHNPblsxXS5yZWYoKX0pYFxuICB9XG4gIGRlcml2YXRpdmUocGFyYW06IFBhcmFtKSB7XG4gICAgY29uc3QgW2EsIGJdID0gdGhpcy5kZXBlbmRzT25cbiAgICBpZiAodGhpcy5pc0NvbnN0KCkpIHtcbiAgICAgIHJldHVybiBgJHtiLnJlZigpfSpwb3coJHthLnJlZigpfSwke2IucmVmKCl9LTEpYFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYHBvdygke2EucmVmKCl9LCR7Yi5yZWYoKX0pKmxvZygke2EucmVmKCl9KSoke2IuZGVyaXZSZWYocGFyYW0pfWBcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgU2luIGV4dGVuZHMgT3Age1xuICBkZWZpbml0aW9uKCkge1xuICAgIHJldHVybiBgc2luKCR7dGhpcy5kZXBlbmRzT25bMF0ucmVmKCl9KWBcbiAgfVxuICBkZXJpdmF0aXZlKHBhcmFtOiBQYXJhbSkge1xuICAgIHJldHVybiBgY29zKCR7dGhpcy5kZXBlbmRzT25bMF0ucmVmKCl9KSoke3RoaXMuZGVwZW5kc09uWzBdLmRlcml2UmVmKHBhcmFtKX1gXG4gIH1cbn1cblxuY2xhc3MgQ29zIGV4dGVuZHMgT3Age1xuICBkZWZpbml0aW9uKCkge1xuICAgIHJldHVybiBgY29zKCR7dGhpcy5kZXBlbmRzT25bMF0ucmVmKCl9KWBcbiAgfVxuICBkZXJpdmF0aXZlKHBhcmFtOiBQYXJhbSkge1xuICAgIHJldHVybiBgLXNpbigke3RoaXMuZGVwZW5kc09uWzBdLnJlZigpfSkqJHt0aGlzLmRlcGVuZHNPblswXS5kZXJpdlJlZihwYXJhbSl9YFxuICB9XG59XG5cbmNsYXNzIE1peCBleHRlbmRzIE9wIHtcbiAgZGVmaW5pdGlvbigpIHtcbiAgICByZXR1cm4gYG1peCgke3RoaXMuZGVwZW5kc09uLm1hcCgob3ApID0+IG9wLnJlZigpKS5qb2luKCcsJyl9KWBcbiAgfVxuICBkZXJpdmF0aXZlKHBhcmFtOiBQYXJhbSkge1xuICAgIGNvbnN0IFthLCBiLCBtaXhdID0gdGhpcy5kZXBlbmRzT25cbiAgICBjb25zdCBhRGVyaXYgPSBgKDEuMC0ke2EucmVmKCl9KSoke21peC5kZXJpdlJlZihwYXJhbSl9KygtJHthLmRlcml2UmVmKHBhcmFtKX0pKiR7bWl4LnJlZigpfWBcbiAgICBjb25zdCBiRGVyaXYgPSBgJHtiLnJlZigpfSoke21peC5kZXJpdlJlZihwYXJhbSl9KyR7Yi5kZXJpdlJlZihwYXJhbSl9KiR7bWl4LnJlZigpfWBcbiAgICByZXR1cm4gYCR7YURlcml2fSske2JEZXJpdn1gXG4gIH1cbn1cblxuY2xhc3MgQ2xhbXAgZXh0ZW5kcyBPcCB7XG4gIGRlZmluaXRpb24oKSB7XG4gICAgcmV0dXJuIGBjbGFtcCgke3RoaXMuZGVwZW5kc09uLm1hcCgob3ApID0+IG9wLnJlZigpKS5qb2luKCcsJyl9KWBcbiAgfVxuICBkZXJpdmF0aXZlKHBhcmFtOiBQYXJhbSkge1xuICAgIGNvbnN0IFt2LCBtaW4sIG1heF0gPSB0aGlzLmRlcGVuZHNPblxuICAgIHJldHVybiBgJHt2LnJlZigpfTwke21pbi5yZWYoKX0gPyAwLjAgOiAoJHt2LnJlZigpfT4ke21heC5yZWYoKX0gPyAwLjAgOiAke3YuZGVyaXZSZWYocGFyYW0pfSlgXG4gIH1cbn1cblxuY2xhc3MgTWluIGV4dGVuZHMgT3Age1xuICBkZWZpbml0aW9uKCkge1xuICAgIHJldHVybiBgbWluKCR7dGhpcy5kZXBlbmRzT24ubWFwKChvcCkgPT4gb3AucmVmKCkpLmpvaW4oJywnKX0pYFxuICB9XG4gIGRlcml2YXRpdmUocGFyYW06IFBhcmFtKSB7XG4gICAgY29uc3QgW2EsIGJdID0gdGhpcy5kZXBlbmRzT25cbiAgICByZXR1cm4gYCR7YS5yZWYoKX08JHtiLnJlZigpfSA/ICR7YS5kZXJpdlJlZihwYXJhbSl9IDogJHtiLmRlcml2UmVmKHBhcmFtKX1gXG4gIH1cbn1cblxuY2xhc3MgTWF4IGV4dGVuZHMgT3Age1xuICBkZWZpbml0aW9uKCkge1xuICAgIHJldHVybiBgbWF4KCR7dGhpcy5kZXBlbmRzT24ubWFwKChvcCkgPT4gb3AucmVmKCkpLmpvaW4oJywnKX0pYFxuICB9XG4gIGRlcml2YXRpdmUocGFyYW06IFBhcmFtKSB7XG4gICAgY29uc3QgW2EsIGJdID0gdGhpcy5kZXBlbmRzT25cbiAgICByZXR1cm4gYCR7YS5yZWYoKX0+JHtiLnJlZigpfSA/ICR7YS5kZXJpdlJlZihwYXJhbSl9IDogJHtiLmRlcml2UmVmKHBhcmFtKX1gXG4gIH1cbn1cblxuY2xhc3MgSWZFbHNlIGV4dGVuZHMgT3Age1xuICBkZWZpbml0aW9uKCkge1xuICAgIGNvbnN0IFtjb25kaXRpb24sIHRoZW5PcCwgZWxzZU9wXSA9IHRoaXMuZGVwZW5kc09uXG4gICAgcmV0dXJuIGAke2NvbmRpdGlvbi5yZWYoKX0/JHt0aGVuT3AucmVmKCl9OiR7ZWxzZU9wLnJlZigpfWBcbiAgfVxuICBkZXJpdmF0aXZlKHBhcmFtOiBQYXJhbSkge1xuICAgIGNvbnN0IFtjb25kaXRpb24sIHRoZW5PcCwgZWxzZU9wXSA9IHRoaXMuZGVwZW5kc09uXG4gICAgcmV0dXJuIGAke2NvbmRpdGlvbi5yZWYoKX0/JHt0aGVuT3AuZGVyaXZSZWYocGFyYW0pfToke2Vsc2VPcC5kZXJpdlJlZihwYXJhbSl9YFxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBdXRvRGlmZiB7XG4gIHByaXZhdGUgbmV4dElEID0gMFxuICBwdWJsaWMgZ2V0TmV4dElEKCk6IG51bWJlciB7XG4gICAgY29uc3QgaWQgPSB0aGlzLm5leHRJRFxuICAgIHRoaXMubmV4dElEKytcbiAgICByZXR1cm4gaWRcbiAgfVxuXG4gIHByaXZhdGUgcGFyYW1zOiB7IFtrZXk6IHN0cmluZ106IFBhcmFtIH0gPSB7fVxuICBwcml2YXRlIG91dHB1dHM6IHsgW2tleTogc3RyaW5nXTogT3AgfSA9IHt9XG4gIHByaXZhdGUgZGVyaXZPdXRwdXRzOiB7IFtwYXJhbTogc3RyaW5nXTogeyBba2V5OiBzdHJpbmddOiBPcCB9IH0gPSB7fVxuXG4gIHByaXZhdGUgY29udmVydFZhbChwYXJhbTogSW5wdXQpOiBPcCB7XG4gICAgaWYgKHBhcmFtIGluc3RhbmNlb2YgT3ApIHtcbiAgICAgIHJldHVybiBwYXJhbVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy52YWwocGFyYW0pXG4gICAgfVxuICB9XG4gIHByaXZhdGUgY29udmVydFZhbHMocGFyYW1zOiBJbnB1dFtdKTogT3BbXSB7XG4gICAgcmV0dXJuIHBhcmFtcy5tYXAoKHBhcmFtKSA9PiB0aGlzLmNvbnZlcnRWYWwocGFyYW0pKVxuICB9XG5cbiAgcHVibGljIHZhbChuOiBudW1iZXIpIHsgcmV0dXJuIG5ldyBWYWx1ZSh0aGlzLCBuKSB9XG4gIHB1YmxpYyBzdW0oLi4ucGFyYW1zOiBJbnB1dFtdKSB7IHJldHVybiBuZXcgU3VtKHRoaXMsIC4uLnRoaXMuY29udmVydFZhbHMocGFyYW1zKSkgfVxuICBwdWJsaWMgYWRkKC4uLnBhcmFtczogSW5wdXRbXSkgeyByZXR1cm4gbmV3IFN1bSh0aGlzLCAuLi50aGlzLmNvbnZlcnRWYWxzKHBhcmFtcykpIH1cbiAgcHVibGljIHN1YihhOiBJbnB1dCwgYjogSW5wdXQpIHtcbiAgICBjb25zdCBbb3BBLCBvcEJdID0gdGhpcy5jb252ZXJ0VmFscyhbYSwgYl0pXG4gICAgcmV0dXJuIHRoaXMuc3VtKG9wQSwgdGhpcy5uZWcob3BCKSlcbiAgfVxuICBwdWJsaWMgbmVnKHY6IElucHV0KSB7IHJldHVybiBuZXcgTmVnKHRoaXMsIHRoaXMuY29udmVydFZhbCh2KSkgfVxuICBwdWJsaWMgbXVsdCguLi5wYXJhbXM6IElucHV0W10pIHtcbiAgICBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMikge1xuICAgICAgcmV0dXJuIG5ldyBNdWx0KHRoaXMsIC4uLnRoaXMuY29udmVydFZhbHMocGFyYW1zKSlcbiAgICB9IGVsc2UgaWYgKHBhcmFtcy5sZW5ndGggPiAyKSB7XG4gICAgICByZXR1cm4gbmV3IE11bHQodGhpcywgdGhpcy5jb252ZXJ0VmFscyhwYXJhbXMuc2xpY2UoMCwgMSkpWzBdLCB0aGlzLm11bHQoLi4ucGFyYW1zLnNsaWNlKDEpKSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBtdWx0KCkgY2FsbGVkIHdpdGggdG9vIGZldyBhcmd1bWVudHM6ICR7cGFyYW1zfWApXG4gICAgfVxuICB9XG4gIHB1YmxpYyBkaXYoYTogSW5wdXQsIGI6IElucHV0KSB7XG4gICAgY29uc3QgW29wQSwgb3BCXSA9IHRoaXMuY29udmVydFZhbHMoW2EsIGJdKVxuICAgIHJldHVybiBuZXcgRGl2KHRoaXMsIG9wQSwgb3BCKVxuICB9XG4gIHB1YmxpYyBwb3coYTogSW5wdXQsIGI6IElucHV0KSB7XG4gICAgY29uc3QgW29wQSwgb3BCXSA9IHRoaXMuY29udmVydFZhbHMoW2EsIGJdKVxuICAgIHJldHVybiBuZXcgUG93KHRoaXMsIG9wQSwgb3BCKVxuICB9XG4gIHB1YmxpYyBzcXJ0KHY6IElucHV0KSB7IHJldHVybiBuZXcgUG93KHRoaXMsIHRoaXMuY29udmVydFZhbCh2KSwgdGhpcy52YWwoMC41KSkgfVxuICBwdWJsaWMgc2luKHY6IElucHV0KSB7IHJldHVybiBuZXcgU2luKHRoaXMsIHRoaXMuY29udmVydFZhbCh2KSkgfVxuICBwdWJsaWMgY29zKHY6IElucHV0KSB7IHJldHVybiBuZXcgQ29zKHRoaXMsIHRoaXMuY29udmVydFZhbCh2KSkgfVxuICBwdWJsaWMgdGFuKHY6IElucHV0KSB7XG4gICAgY29uc3Qgb3AgPSB0aGlzLmNvbnZlcnRWYWwodilcbiAgICByZXR1cm4gdGhpcy5kaXYodGhpcy5zaW4ob3ApLCB0aGlzLmNvcyhvcCkpXG4gIH1cbiAgcHVibGljIG1peChhOiBJbnB1dCwgYjogSW5wdXQsIG1peDogSW5wdXQpIHsgcmV0dXJuIG5ldyBNaXgodGhpcywgLi4udGhpcy5jb252ZXJ0VmFscyhbYSwgYiwgbWl4XSkpIH1cbiAgcHVibGljIGNsYW1wKHY6IElucHV0LCBtaW46IElucHV0LCBtYXg6IElucHV0KSB7IHJldHVybiBuZXcgQ2xhbXAodGhpcywgLi4udGhpcy5jb252ZXJ0VmFscyhbdiwgbWluLCBtYXhdKSkgfVxuICBwdWJsaWMgbWluKGE6IElucHV0LCBiOiBJbnB1dCkgeyByZXR1cm4gbmV3IE1pbih0aGlzLCAuLi50aGlzLmNvbnZlcnRWYWxzKFthLCBiXSkpIH1cbiAgcHVibGljIG1heChhOiBJbnB1dCwgYjogSW5wdXQpIHsgcmV0dXJuIG5ldyBNYXgodGhpcywgLi4udGhpcy5jb252ZXJ0VmFscyhbYSwgYl0pKSB9XG4gIHB1YmxpYyBpZmVsc2UoY29uZDogSW5wdXQsIHRoZW5PcDogSW5wdXQsIGVsc2VPcDogSW5wdXQpIHsgcmV0dXJuIG5ldyBJZkVsc2UodGhpcywgLi4udGhpcy5jb252ZXJ0VmFscyhbY29uZCwgdGhlbk9wLCBlbHNlT3BdKSkgfVxuICBwdWJsaWMgZSgpIHsgcmV0dXJuIHRoaXMudmFsKE1hdGguRSkgfVxuICBwdWJsaWMgcGkoKSB7IHJldHVybiB0aGlzLnZhbChNYXRoLlBJKSB9XG5cbiAgcHVibGljIHBhcmFtKG5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IG9wID0gbmV3IFBhcmFtKHRoaXMsIG5hbWUpXG4gICAgdGhpcy5wYXJhbXNbbmFtZV0gPSBvcFxuICAgIHJldHVybiBvcFxuICB9XG5cbiAgcHVibGljIG91dHB1dChuYW1lOiBzdHJpbmcsIG9wOiBPcCkge1xuICAgIHRoaXMub3V0cHV0c1tuYW1lXSA9IG9wXG4gIH1cblxuICBwdWJsaWMgb3V0cHV0RGVyaXYobmFtZTogc3RyaW5nLCBwYXJhbTogUGFyYW0gfCBzdHJpbmcsIG9wOiBPcCkge1xuICAgIGNvbnN0IHBhcmFtTmFtZSA9IHR5cGVvZiBwYXJhbSA9PT0gJ3N0cmluZycgPyBwYXJhbSA6IHBhcmFtLm5hbWVcbiAgICB0aGlzLmRlcml2T3V0cHV0c1twYXJhbU5hbWVdID0gdGhpcy5kZXJpdk91dHB1dHNbcGFyYW1OYW1lXSB8fCB7fVxuICAgIHRoaXMuZGVyaXZPdXRwdXRzW3BhcmFtTmFtZV1bbmFtZV0gPSBvcFxuICB9XG5cbiAgcHVibGljIGdlbigpOiBzdHJpbmcge1xuICAgIGxldCBjb2RlID0gJydcblxuICAgIC8vIEFkZCBpbml0aWFsaXplcnMgZm9yIG91dHB1dHNcbiAgICBjb25zdCBkZXBzID0gbmV3IFNldDxPcD4oKVxuICAgIGZvciAoY29uc3QgbmFtZSBpbiB0aGlzLm91dHB1dHMpIHtcbiAgICAgIGZvciAoY29uc3QgZGVwIG9mIHRoaXMub3V0cHV0c1tuYW1lXS5kZWVwRGVwZW5kZW5jaWVzKCkudmFsdWVzKCkpIHtcbiAgICAgICAgZGVwcy5hZGQoZGVwKVxuICAgICAgfVxuICAgICAgZGVwcy5hZGQodGhpcy5vdXRwdXRzW25hbWVdKVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IHBhcmFtIGluIHRoaXMuZGVyaXZPdXRwdXRzKSB7XG4gICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gdGhpcy5kZXJpdk91dHB1dHNbcGFyYW1dKSB7XG4gICAgICAgIGZvciAoY29uc3QgZGVwIG9mIHRoaXMuZGVyaXZPdXRwdXRzW3BhcmFtXVtuYW1lXS5kZWVwRGVwZW5kZW5jaWVzKCkudmFsdWVzKCkpIHtcbiAgICAgICAgICBkZXBzLmFkZChkZXApXG4gICAgICAgIH1cbiAgICAgICAgZGVwcy5hZGQodGhpcy5kZXJpdk91dHB1dHNbcGFyYW1dW25hbWVdKVxuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGRlcCBvZiBkZXBzLnZhbHVlcygpKSB7XG4gICAgICBjb2RlICs9IGRlcC5pbml0aWFsaXplcigpXG4gICAgfVxuXG4gICAgLy8gQWRkIG91dHB1dHNcbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gdGhpcy5vdXRwdXRzKSB7XG4gICAgICBjb2RlICs9IGBmbG9hdCAke25hbWV9PSR7dGhpcy5vdXRwdXRzW25hbWVdLnJlZigpfTtcXG5gXG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBwYXJhbSBpbiB0aGlzLmRlcml2T3V0cHV0cykge1xuICAgICAgY29uc3QgcGFyYW1PcCA9IHRoaXMucGFyYW1zW3BhcmFtXVxuXG4gICAgICAvLyBBZGQgaW5pdGlhbGl6ZXJzIGZvciBkZXJpdmF0aXZlIG91dHB1dHNcbiAgICAgIGNvbnN0IGRlcml2RGVwcyA9IG5ldyBTZXQ8T3A+KClcbiAgICAgIGZvciAoY29uc3QgbmFtZSBpbiB0aGlzLmRlcml2T3V0cHV0c1twYXJhbV0pIHtcbiAgICAgICAgZm9yIChjb25zdCBkZXAgb2YgdGhpcy5kZXJpdk91dHB1dHNbcGFyYW1dW25hbWVdLmRlZXBEZXBlbmRlbmNpZXMoKS52YWx1ZXMoKSkge1xuICAgICAgICAgIGRlcml2RGVwcy5hZGQoZGVwKVxuICAgICAgICB9XG4gICAgICAgIGRlcml2RGVwcy5hZGQodGhpcy5kZXJpdk91dHB1dHNbcGFyYW1dW25hbWVdKVxuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBkZXAgb2YgZGVyaXZEZXBzLnZhbHVlcygpKSB7XG4gICAgICAgIGNvZGUgKz0gZGVwLmRlcml2SW5pdGlhbGl6ZXIocGFyYW1PcClcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIGRlcml2YXRpdmUgb3V0cHV0c1xuICAgICAgZm9yIChjb25zdCBuYW1lIGluIHRoaXMuZGVyaXZPdXRwdXRzW3BhcmFtXSkge1xuICAgICAgICBjb2RlICs9IGBmbG9hdCAke25hbWV9PSR7dGhpcy5kZXJpdk91dHB1dHNbcGFyYW1dW25hbWVdLmRlcml2UmVmKHBhcmFtT3ApfTtcXG5gXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvZGVcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge31cblxuICBwdWJsaWMgc3RhdGljIGdlbihjYjogKGFkOiBBdXRvRGlmZikgPT4gT3ApOiBzdHJpbmcge1xuICAgIGNvbnN0IGFkID0gbmV3IEF1dG9EaWZmKClcbiAgICBjYihhZClcbiAgICByZXR1cm4gYWQuZ2VuKClcbiAgfVxufVxuXG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIFdpbmRvdyB7IEF1dG9EaWZmOiBhbnk7IH1cbn1cbndpbmRvdy5BdXRvRGlmZiA9IHdpbmRvdy5BdXRvRGlmZiB8fCBBdXRvRGlmZlxuIl0sInNvdXJjZVJvb3QiOiIifQ==